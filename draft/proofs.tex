\subsection{Proof of Lifted Retract (Lemma~\ref{lemma:lifted_retract})}
\label{subsec:proof_of_lifted_retract}
This is a proof by induction on the form of $[[A]]$.

\begin{itemize}
\item[] Case. Suppose $[[A]]$ is atomic.  Then:
  \[
    [[lbox A]];[[lunbox A]] = [[box A]];[[unbox A]] = \id_{[[A]]}
    \]
    
  \item[] Case. Suppose $[[A]]$ is $[[?]]$.  Then:
    \[
    \begin{array}{lll}
      [[lbox A]];[[lunbox A]] & = & [[lbox ?]];[[lunbox ?]]\\
      & = & \id_{[[?]]};\id_{[[?]]}\\
      & = & \id_{[[?]]}\\
      & = & \id_{[[A]]}
    \end{array}
    \]

  \item[] Case. Suppose $[[A]] = [[A1 -> A2]]$.  Then:
    \[\small
    \begin{array}{lll}
      [[lbox A]];[[lunbox A]]
      & = & [[lbox (A1 -> A2)]];[[lunbox (A1 -> A2)]]\\
      & = & ([[lunbox A1]] \to [[lbox A2]]);([[lbox A1]] \to [[lbox A2]])\\
      & = & ([[lbox A1]];[[lunbox A1]]) \to ([[lbox A2]];[[lunbox A2]])\\
    \end{array}
    \]
    By two applications of the induction hypothesis we know the
    following:
    \[
    \begin{array}{lll}
      [[lbox A1]];[[lunbox A1]] = \id_{[[A1]]} & \text{ and } & [[lbox A2]];[[lunbox A2]] = \id_{[[A2]]}
    \end{array}
    \]
    Thus, we know the following:
    \[
    \begin{array}{lll}
      ([[lbox A1]];[[lunbox A1]]) \to ([[lbox A2]];[[lunbox A2]])
      & = & \id_{[[A1]]} \to \id_{[[A2]]}\\
      & = & \id_{[[A1 -> A2]]}\\
      & = & \id_{[[A]]}
    \end{array}
    \]

  \item[] Case. Suppose $[[A]] = [[A1 x A2]]$.  Then:
    \[\small
    \begin{array}{lll}
      [[lbox A]];[[lunbox A]]
      & = & [[lbox (A1 x A2)]];[[lunbox (A1 x A2)]]\\
      & = & ([[lbox A1]] \times [[lbox A2]]);([[lunbox A1]] \times [[lbox A2]])\\
      & = & ([[lbox A1]];[[lunbox A1]]) \times ([[lbox A2]];[[lunbox A2]])\\
    \end{array}
    \]
    By two applications of the induction hypothesis we know the
    following:
    \[
    \begin{array}{lll}
      [[lbox A1]];[[lunbox A1]] = \id_{[[A1]]} & \text{ and } & [[lbox A2]];[[lunbox A2]] = \id_{[[A2]]}
    \end{array}
    \]
    Thus, we know the following:
    \[
    \begin{array}{lll}
      ([[lbox A1]];[[lunbox A1]]) \times ([[lbox A2]];[[lunbox A2]])
      & = & \id_{[[A1]]} \times \id_{[[A2]]}\\
      & = & \id_{[[A1 x A2]]}\\
      & = & \id_{[[A]]}
    \end{array}
    \]
\end{itemize}
% subsection proof_of_lifted_retract (end)

\subsection{Proof of Lemma~\ref{lemma:S_is_faithful}}
\label{subsec:proof_of_S_is_faithful}
We must show that the function
\[ \S_{A,B} : \Hom{C}{A}{B} \mto \Hom{S}{\S A}{\S B} \]
is injective.

So suppose $f \in \Hom{C}{A}{B}$ and $g \in \Hom{C}{A}{B}$ such that
$\S f = \S g : \S A \mto \S B$.  Then we can easily see that:
\[
\begin{array}{lll}
  \S f & = & [[lunbox A]];f;[[lbox B]] \\
  & = & [[lunbox A]];g;[[lbox B]]\\
  & = & \S g\\
\end{array}
\]
But, we have the following equalities:
\[
\begin{array}{rll}
  [[lunbox A]];f;[[lbox B]] & = & [[lunbox A]];g;[[lbox B]]\\
  [[lbox A]];[[lunbox A]];f;[[lbox B]];[[lunbox B]] & = & [[lbox A]];[[lunbox A]];g;[[lbox B]];[[lunbox B]]\\
  \id_A;f;[[lbox B]];[[lunbox B]] & = & \id_A;g;[[lbox B]];[[lunbox B]]\\
  \id_A;f;\id_B & = & \id_A;g;\id_B\\
  f & = & g\\
\end{array}
\]
The previous equalities hold due to
Lemma~\ref{lemma:lifted_retract}.
% subsection proof_of_S_is_faithful (end)

\subsection{Proof of Type Consistency in the Model (Lemma~\ref{lemma:type_consistency_in_the_model})}
\label{subsec:proof_of_type_consistency_in_the_model}
This is a proof by induction on the form of $[[A ~ B]]$.
\begin{itemize}
\item[] Case.
  \[
  \SLGradydrulerefl{}
  \]
  Choose $c_1 = c_2 = \id_A : [[A --> A]]$.

\item[] Case.
  \[
  \SLGradydrulebox{}
  \]
  Choose $c_1 = [[Box A]] : [[A --> ?]]$ and $c_2 = [[Unbox A]] : [[? -> A]]$.

\item[] Case.
  \[
  \SLGradydruleunbox{}
  \]
  Choose $c_1 = [[Unbox A]] : [[? --> A]]$ and $c_2 = [[Box A]] : [[A -> ?]]$.
  
\item[] Case.
  \[
  \SLGradydrulearrow{}
  \]
  By the induction hypothesis there exists four casting morphisms
  $c'_1 : [[A1 --> A2]]$, $c'_2 : [[A2 --> A1]]$, $c'_3 : [[B1 --> B2]]$,
  and $c'_4 : [[B2 --> B1]]$.  Choose
  $c_1 = c'_2 \to c'_3 : [[(A1 -> B1) --> (A2 -> B2)]]$
  and
  $c_2 = c'_1 \to c'_4 : [[(A2 -> B2) --> (A1 -> B1)]]$.

\item[] Case.
  \[
  \SLGradydruleprod{}
  \]
  By the induction hypothesis there exists four casting morphisms
  $c'_1 : [[A1 --> A2]]$, $c'_2 : [[A2 --> A1]]$, $c'_3 : [[B1 --> B2]]$,
  and $c'_4 : [[B2 --> B1]]$.
  Choose
  $c_1 = c'_1 \times c'_3 : [[H(A1 x B1) --> H(A2 x B2)]]$
  and
  $c_2 = c'_2 \times c'_4 : [[H(A2 x B2) --> H(A1 x B1)]]$.
\end{itemize}
% subsection proof_of_type_consistency_in_the_model (end)

\subsection{Proof of Interpretation of Types Theorem~\ref{thm:interpretation_of_typing}}
\label{subsec:proof_of_interpretation_of_types}
This is a proof by induction on $[[G |- t : A]]$.  First, we show
how to interpret the rules of $\lambda^?_\to$, and then
$\lambda^{\langle [[A]] \rangle}_\to$.

\begin{itemize} 
\item[] Case.
  \[
  \SLGradydrulevar{}
  \]
  Suppose with out loss of generality that $[[ [| G |] ]] = [[A1]]
  \times \cdots \times [[Ai]] \times \cdots \times [[Aj]]$ where
  $[[Ai]] = [[A]]$.  We know that $j > 0$ or the assumed typing
  derivation would not hold.  Then take
  $[[ [| x |] ]] = \pi_i : [[ [| G |] --> A]]$.

\item[] Case.
  \[
  \SLGradydruleunit{}
  \]

  Take $[[ [| triv |] ]] = \diamond_{[[ [| G |] ]]} : [[ [| G |] -->
      1]]$ where $\diamond_{[[ [| G |] ]]}$ is the unique terminal
  arrow that exists because $\cat{C}$ is cartesian closed.
  
\item[] Case.
  \[
  \SLGradydrulezero{}
  \]

  Take $[[ [| 0 |] ]] = \diamond_{[[ [| G |] ]]};\z : [[ [| G |] --> Nat]]$
  where $\z : [[1 --> Nat]]$ exists because $\cat{C}$
  contains a SNNO.

\item[] Case.
  \[
  \SLGradydrulesucc{}
  \]
  By the induction hypothesis there is a morphism \\ $[[ [| t |] ]] : [[ [| G |] --> Nat]]$.  Then
  take $[[ [| succ t |] ]] = [[ [| t |] ]];[[succ]] : [[ [| G |] --> Nat ]]$, where
  $[[succ]] : [[Nat --> Nat]]$ exists because $\cat{C}$ has a SNNO.
  
\item[] Case.
  \[
  \SLGradydrulepair{}
  \]
  By two applications of the induction hypothesis there are two morphisms
  $[[ [| t1 |] ]] : [[ [| G |] --> A]]$ and $[[ [| t2 |] ]] : [[ [| G |] --> B]]$.
  Then using the fact that $\cat{C}$ is cartesian we take
  $[[ [| (t1 , t2) |] ]] = \langle [[ [| t1 |] ]] , [[ [| t2 |] ]] \rangle : [[ [| G |] --> H(A x B)]]$.

\item[] Case.
  \[
  \SLGradydrulefstC{}
  \]
  By the induction hypothesis there is a morphism \\ $[[ [| t |] ]] :
  [[ [| G |] --> H(A1 x B) ]]$, and by type consistency in the model
  (Lemma~\ref{lemma:type_consistency_in_the_model}) there exists a
  casting morphism $c_1 : [[A1 --> A2]]$.
  Finally, take $[[ [| fst t |] ]] = [[ [| t |] ]];\pi_1;c_1 : [[ [| G |] --> A2]]$.

\item[] Case.
  \[
  \SLGradydrulesndC{}
  \]
  By the induction hypothesis there is a morphism \\ $[[ [| t |] ]] :
  [[ [| G |] --> H(A x B1) ]]$, and by type consistency in the model
  (Lemma~\ref{lemma:type_consistency_in_the_model}) there exists a
  casting morphism $c_1 : [[B1 --> B2]]$.
  Finally, take $[[ [| snd t |] ]] = [[ [| t |] ]];\pi_2;c_1 : [[ [| G |] --> B2]]$.

\item[] Case.
  \[
  \SLGradydrulelam{}
  \] 
  By the induction hypothesis there is a morphism $[[ [| t |] ]] :
  [[ H([| G |] x A) --> B]]$.  Then take $[[ [| \x : A.t |] ]] =
  \curry {[[ [| t |] ]]} : [[ [| G |] --> (A -> B)]]$, where
  $\mathsf{curry} : \Hom{C}{X \times Y}{Z} \mto \Hom{C}{X}{Y \to Z}$
  exists because $\cat{C}$ is closed.

\item[] Case.
  \[
  \SLGradydruleappC{}
  \]
  By two applications of the induction hypothesis there are
  morphisms $[[ [| t1 |] ]] : [[ [| G |] --> (A1 -> B)]]$ and $[[ [|
        t2 |] ]] : [[ [| G |] --> A2]]$, and by type consistency in the model
  (Lemma~\ref{lemma:type_consistency_in_the_model}) there exists a
  casting morphism $c_2 : [[A2 --> A1]]$.
  Then take $[[ [| t1 t2 |] ]] = \langle [[ [| t1 |] ]] , [[ [| t2 |] ]];c_1 \rangle ; \app_{[[A]],[[B]]} : [[ [| G |] --> B]]$.
  The morphism $\app_{[[A]],[[B]]} : [[ H((A -> B) x A) --> B]]$ exists because $\cat{C}$ is closed.
  
\item[] Case.
  \[
  \SLGradydrulesuccU{}
  \]
  By the induction hypothesis there is a morphism $[[ [| t |] ]] :
  [[ [| G |] --> ?]]$.  In addition, we know that $[[? ~ Nat]]$
  always holds, and its casing morphisms are $[[unbox Nat]] : [[? -->
      Nat]]$ and $[[box Nat]] : [[Nat --> ?]]$.
  Thus, take $[[ [| succ t |] ]] = [[ [| t |] ]];[[unbox Nat]];[[succ]];[[box Nat]]$.

\item[] Case.
  \[
  \SLGradydrulefstU{}
  \]
  By the induction hypothesis there is a morphism $[[ [| t |] ]] :
  [[ [| G |] --> ?]]$.  In addition, we know that $[[? ~ ? x ?]]$, and its casting morphisms are
  $[[split ? x ?]] : [[? --> H(? x ?)]]$ and $[[squash ? x ? : H(? x ?) --> ?]]$.
  Then take $[[ [| fst t |] ]] = [[ [| t |] ]];[[split ? x ?]];\pi_1 : [[ [| G |] --> ?]]$.
  
\item[] Case.
  \[
  \SLGradydrulesndU{}
  \]
  By the induction hypothesis there is a morphism $[[ [| t |] ]] :
  [[ [| G |] --> ?]]$.  In addition, we know that $[[? ~ ? x ?]]$, and its casting morphisms are
  $[[split ? x ?]] : [[? --> H(? x ?)]]$ and $[[squash ? x ? : H(? x ?) --> ?]]$.
  Then take $[[ [| snd t |] ]] = [[ [| t |] ]];[[split ? x ?]];\pi_2 : [[ [| G |] --> ?]]$.    
  
\item[] Case.
  \[
  \SLGradydruleappU{}
  \]
  By the induction hypothesis there are morphisms $[[ [| t1 |] ]] : [[ [| G |] --> ?]]$
  and $[[ [| t2 |] ]] : [[ [| G |] --> A]]$.  In addition, we know that $[[? ~ ? -> ?]]$ and $[[? ~ A]]$, and the
  casting morphisms are
  $[[split ? -> ?]] : [[? --> (? -> ?)]]$ and $[[squash ? -> ? : (? -> ?) --> ?]]$, and
  $[[Unbox A]] : [[? --> A]]$ and $[[Box A]] : [[A --> ?]]$.  
  Then take $[[ [| t1 t2 |] ]] = \langle [[ [| t1 |] ]];[[split ? -> ?]] , [[ [| t2 |] ]];[[Box A]] \rangle;\app_{?,?}$.
\end{itemize}

Next we turn to $\lambda^{\langle [[A]] \rangle }_\to$, but we do
not show every rule, because it corresponds to the simply typed
$\lambda$-calculus whose interpretation is similar to what we have
already shown above except without casting morphism, and so we only
show the case for the cast rule.
\begin{itemize}
\item[] Case.
  \[
  \SLGradydrulecast{}
  \]
  By the induction hypothesis there is a morphism $[[ [| t |] ]] : [[ [| G |] --> A]]$,
  and by type consistency in the model (Lemma~\ref{lemma:type_consistency_in_the_model})
  there is a casting morphism $c_1 : [[A --> B]]$.  So take
  $[[ [| < B > t |] ]] = [[ [| t |] ]];c_1 : [[ [| G |] --> B]]$.
\end{itemize}

% subsection proof_of_interpretation_of_types (end)

\subsection{Proof of Interpretation of Evaluation (Theorem~\ref{thm:interpretation_of_evaluation})}
\label{subsec:proof_of_interpretation_of_evaluation}
This proof holds by induction on the form of $[[G |- t1 ~> t2 : A]]$.
We only show the cases for the casting rules, because the others are
well-known to hold within any cartesian closed category; see
\cite{Lambek:1980} or \cite{Crole:1994}.  We will routinely use
Theorem~\ref{thm:interpretation_of_typing} throughout this proof
without mention.

\begin{itemize}  
\item[] Case.
  \[
  \SLGradydrulerdAXXvalues{} 
  \]
  This case is trivial.

\item[] Case.
  \[
  \SLGradydrulerdAXXcastA{} 
  \]

  Either $[[drop-cast v]] = v$ which implies that $v$ is a simple
  value, or $v = [[<?>s]]$ for some simple value $[[s]]$, and
  $[[drop-cast v]] = [[s]]$.

  \ \\
  If the former is true, then it must be the case that $[[G |- v :
      C]]$, and $[[G |- <C>v : C]]$ holds using the casting rule
  $[[C ~ C]]$, and its casting morphism is $\id_C : [[C --> C]]$.
  Thus, $[[ [| <C>v |] ]] = [[ [| v |] ]];\id_C = [[ [| v |] ]] = [[ [| drop-cast v |] ]]$.

  \ \\ Now suppose $v = [[<?>s]]$ for some simple value $[[s]]$.
  Then it must be the case that the typing derivation of $[[
      <C>v]]$ has the following form:
  \begin{center}
    \begin{math}
      $$\mprset{flushleft}
      \inferrule* [right=] {
        $$\mprset{flushleft}
        \inferrule* [right=] {
          [[G |- s : B]]
          \\
          $$\mprset{flushleft}
          \inferrule* [right=] {
            \
          }{[[B ~ ?]]}
        }{[[G |- <?>s : ?]]}
        \\
        $$\mprset{flushleft}
        \inferrule* [right=] {
          \,
        }{[[? ~ C]]}
      }{[[G |- <C><?>s : C]]}
    \end{math}
  \end{center}      
  This implies that
  \[
  \begin{array}{lll}
    [[ [| <C><?>s |] ]]
    & = & [[ [| s |] ]];[[Box B]];[[Unbox B]]\\
    & = & [[ [| s |] ]] ;\id_B \\
    & = & [[ [| s |] ]]\\
    & = & [[ [| drop-cast v |] ]]
  \end{array}
  \]
  The previous equality holds by
  Lemma~\ref{lemma:casting_morphisms}.

\item[] Case.
  \[
  \SLGradydrulerdAXXcastNat{} 
  \]

  It must be the case that the typing derivation of $[[ <Nat>(succ
      t)]]$ ends as follows:
  \begin{center}
    \begin{math}
      $$\mprset{flushleft}
      \inferrule* [right=] {
        $$\mprset{flushleft}
        \inferrule* [right=] {
          [[G |- t : ?]]
        }{[[G |- succ t : ?]]}
        \\
        $$\mprset{flushleft}
        \inferrule* [right=] {
          \,
        }{[[? ~ Nat]]}
      }{[[G |- <Nat>(succ t) : Nat]]}
    \end{math}
  \end{center}
  Then
  \[
  \begin{array}{lll}
    [[ [| <Nat>(succ t) |] ]]
    & = & [[ [| succ t |] ]];[[unbox Nat]]\\
    & = & ([[ [| t |] ]];[[unbox Nat]];[[succ]];[[box Nat]]);[[unbox Nat]]\\
    & = & [[ [| t |] ]];([[unbox Nat]];[[succ]];[[box Nat]];[[unbox Nat]])\\
    & = & [[ [| t |] ]];([[unbox Nat]];[[succ]];\id_{[[Nat]]})\\
    & = & [[ [| t |] ]];([[unbox Nat]];[[succ]])\\
    & = & ([[ [| t |] ]];[[unbox Nat]]);[[succ]]\\
    & = & [[ [| succ (<Nat> t) |] ]]
  \end{array}
  \]
  The previous equality holds by
  Lemma~\ref{lemma:casting_morphisms} and because it must be the case that the typing derivation
  of $[[succ <Nat>t]]$ ends as follows:
  \begin{center}
    \begin{math}
      $$\mprset{flushleft}
      \inferrule* [right=] {
        $$\mprset{flushleft}
        \inferrule* [right=] {          
          [[G |- t : ?]]          
          \\
          $$\mprset{flushleft}
          \inferrule* [right=] {
            \,
          }{[[? ~ Nat]]}
        }{[[G |- <Nat>t : Nat]]}
      }{[[G |- succ <Nat>t : Nat]]}
    \end{math}
  \end{center}   

\item[] Case.    
  \begin{center}
    \small
    \begin{math}
      $$\mprset{flushleft}
      \inferrule* [right=$\SLGradydrulerdAXXcastArrowName{}$] {
        [[G |- t : A1 -> B1 && (A1 -> B1) ~ (A2 -> B2)]]
      }{[[G |- <A2 -> B2>t ~> \y : A2.<B2> (t <A1>y) : A2 -> B2]]}
    \end{math}
  \end{center}     

  This case requires the following basic results about cartesian
  closed categories.  First, there is a natural bijection:
  \[
  \mathsf{curry} : \Hom{C}{[[X x Y]]}{[[Z]]} \mto \Hom{C}{[[X]]}{[[Y -> Z]]}
  \]    
  This bijection implies the following equalities:
  \[
  \begin{array}{lll}
    \curry{\app_{X,Y}} & = & \id_{[[X -> Y]]}\\
    \curry{(f \times g);x;h} & = & f;\curry{x};(g \to h)\\
  \end{array}
  \]

  We know from type consistency in the model
  (Lemma~\ref{lemma:type_consistency_in_the_model} and
  Corollary~\ref{corollary:type_consist_coro}) that there is a
  casting morphism $c_1 \to c_2 : [[(A1 -> B1) --> (A2 -> B2)]]$
  where $c_1 : [[A2 --> A1]]$ and $c_2 : [[B1 --> B2]]$.

  It suffices to show that:
  \[
  \begin{array}{lll}
    [[ [| <A2 -> B2>t |] ]]
    & = & [[ [| t |] ]];(c_1 \to c_2)\\      
    & = & \curry{([[ [| t |] ]] \times c_1);\app_{[[A1]],[[B1]]};c_2}\\
    & = & [[ [| \y : A2.<B2> (t <A1>y) |] ]]\\
  \end{array}
  \]    
  We prove this equality from right to left as follows:
  \[
  \begin{array}{lll}
    [[ [| \y : A2.<B2> (t <A1>y) |] ]]
    & = & \curry{([[ [| t |] ]] \times c_1);\app_{[[A1]],[[B1]]};c_2}\\
    & = & [[ [| t |] ]];\curry{\app_{[[A1]],[[B1]]}};(c_1 \to c_2)\\
    & = & [[ [| t |] ]];\id_{[[A1 -> B1]]};(c_1 \to c_2)\\
    & = & [[ [| t |] ]];(c_1 \to c_2)\\
    & = & [[ [| <A2 -> B2>t |] ]]
  \end{array}
  \]

\item[] Case.    %% \SLGradydrulerdAXXcastPair{}    
  \begin{center}
    \small
    \begin{math}
      $$\mprset{flushleft}
      \inferrule* [right=$\SLGradydrulerdAXXcastPairName{}$] {
        [[G |- t : A1 x B1 && (A1 x B1) ~ (A2 x B2)]]
      }{[[G |- <A2 x B2>t ~> (<A2>(fst t),<B2>(snd t)) : A2 x B2]]}
    \end{math}
  \end{center}
  We know from type consistency in the model
  (Lemma~\ref{lemma:type_consistency_in_the_model} and
  Corollary~\ref{corollary:type_consist_coro}) that there is a
  casting morphism $c_1 \times c_2 : [[(A1 x B1) --> (A2 x B2)]]$
  where $c_1 : [[A1 --> A2]]$ and $c_2 : [[B1 --> B2]]$.

  It suffices to show that:
  \[
  \begin{array}{lll}
    [[ [| <A2 x B2>t |] ]]
    & = & [[ [| t |] ]];(c_1 \times c_2)\\
    & = & \langle [[ [| t |] ]];\pi_1;c_1 , [[ [| t |] ]];\pi_2;c_2 \rangle\\
    & = & [[ [| (<A2>(fst t),<B2>(snd t)) |] ]]
  \end{array}
  \]
  This equality holds using the following well known fact on
  cartesian categories:
  \[
  \langle f;g,f;h \rangle = f;(g \times h)
  \]

\item[] Case.
  \[
  \SLGradydrulerdAXXcast{} 
  \]
  By the induction hypothesis we know that
  $[[ [| t1 |] ]] = [[ [| t2 |] ]] : [[ [| G |] --> A]]$, and by
  type consistency in the model
  (Lemma~\ref{lemma:type_consistency_in_the_model}) there is a
  casting morphism $c : [[A --> B]]$.

  Then it suffices to show that:
  \[
  \begin{array}{lll}
    [[ [| <B>t1 |] ]]
    & = & [[ [| t1 |] ]];c\\
    & = & [[ [| t2 |] ]];c\\
    & = & [[ [| <B>t2 |] ]]
  \end{array}
  \]
  But, this clearly holds by the fact that $[[ [| t1 |] ]] = [[ [| t2 |] ]] : [[ [| G |] --> A]]$.
\end{itemize}
% subsection proof_of_interpretation_of_evaluation (end)

\subsection{Proof of Lemma~\ref{lemma:syntactic_box_and_unbox}}
\label{subsec:proof_of_lemma_syntactic_box_and_unbox}
First, we define the identify meta-function:
  \[
  \id_A := [[\x : A . x]]
  \]
  Then composition.  Suppose $[[G |- t1 : A -> B]]$ and $[[G |- t2 : B -> D]]$
  are two terms, then we define:
  \[
  [[t1 ; t2]] := [[\x : A . H(t2 (t1 x))]]
  \]
  It is easy to see that the following rule is admissible:
  \begin{center}
    \begin{math}
      $$\mprset{flushleft}
      \inferrule* [right=\text{comp}] {
        [[G |- t1 : A -> B]]
        \\
          [[G |- t2 : B -> D]]
      }{[[G |- t1;t2 : A -> D]]}
    \end{math}
  \end{center}
  The functor $- \times -$ requires two morphisms $[[G |- t1 : A -> D]]$ and
  $[[G |- t2 : B -> E]]$, and is defined as follows:
  \[
  [[t1]] \times [[t2]] := [[\ x : A x B.(t1 (fst x), t2 (snd x))]]
  \]
  The following rule is admissible:
  \begin{center}
    \begin{math}
      $$\mprset{flushleft}
      \inferrule* [right=\text{prod}] {
        [[G |- t1 : A -> D]]
        \\
        [[G |- t2 : B -> E]]
      }{[[G |- t1 XX t2 : H(A x B) -> H(D x E)]]}
    \end{math}
  \end{center}
  The functor $- \to -$ requires two morphisms $[[G |- t1 : D -> A]]$ and
  $[[G |- t2 : B -> E]]$, and is defined as follows:
  \[
  [[t1 -> t2]] := [[\ f : A -> B.\y : D.H(t2 (f (t1 y)))]]
  \]
  The following rule is admissible:
  \begin{center}
    \begin{math}
      $$\mprset{flushleft}
      \inferrule* [right=\text{prod}] {
        [[G |- t1 : D -> A]]
        \\
        [[G |- t2 : B -> E]]
      }{[[G |- t1 -> t2 : (A -> B) -> (D -> E)]]}
    \end{math}
  \end{center}
  At this point it is straightforward to carry out the definition of
  $[[Box A]]$ and $[[Unbox A]]$ using the definitions from the model.
  Showing the admissibility of the typing and reduction rules follows
  by induction on $[[A]]$.
% subsection proof_of_lemma_syntactic_box_and_unbox (end)

%%% Local Variables: ***
%%% mode:latex ***
%%% TeX-master: "main.tex"  ***
%%% End: ***
