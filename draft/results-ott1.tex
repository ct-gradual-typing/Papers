\begin{lemma}[Inclusion of Bounded System F]
  \label{lemma:F-inclusion}
  Suppose $t$ is fully annotated and does not contain any applications
  of $ \mathsf{box} $ or $ \mathsf{unbox} $, and $\SGradynt{A}$ is static.  Then
  \begin{itemize}
  \item[i.] $ \Gamma  \vdash_F  \SGradynt{t}  :  \SGradynt{A} $ if and only if $\, \Gamma  \vdash  \SGradynt{t}  :  \SGradynt{A} $, and 
  \item[ii.] $ \SGradynt{t}  \rightsquigarrow^*_F  \SGradynt{t'} $ if and only if $ \SGradynt{t}  \rightsquigarrow^*  \SGradynt{t'} $.
  \end{itemize}
\end{lemma}
\begin{proof}
  We give proof sketches for both parts.  The interesting cases are
  the right-to-left directions of each part.  If we simply remove all
  rules mentioning the unknown type $\SGradysym{\mbox{?}}$ and the type consistency
  relation, and then remove $ \mathsf{box} $, $ \mathsf{unbox} $, and $\SGradysym{\mbox{?}}$ from
  the syntax of Surface Grady, then what we are left with is bounded
  system F.  Since $\SGradynt{t}$ is fully annotated and $\SGradynt{A}$ is static,
  then $ \Gamma  \vdash  \SGradynt{t}  :  \SGradynt{A} $ will hold within this fragment.

  Moving on to part two, first, we know that $\SGradynt{t}$ does not contain
  any occurrence of $ \mathsf{box} $ or $ \mathsf{unbox} $ and is fully annotated.
  This implies that $\SGradynt{t}$ lives within the bounded system F fragment
  of Surface Grady. Thus, before evaluation of $\SGradynt{t}$ Surface Grady
  will apply the cast insertion algorithm which will at most insert
  applications of the identity function into $\SGradynt{t}$ producing a term
  $\widehat{\SGradynt{t}}$, but then after potentially more than one step of
  evaluation within Core Grady, those applications of the identity
  function will be $\beta$-reduced away resulting in $\widehat{\SGradynt{t}}
  \rightsquigarrow^* \SGradynt{t} \rightsquigarrow^* \SGradynt{t'}$.  In addition,
  since $\SGradynt{t}$ in Surface Grady is the exact same program as $\SGradynt{t}$
  in bounded system F, then we know $ \SGradynt{t}  \rightsquigarrow^*_F  \SGradynt{t'} $ will hold.
\end{proof}

\begin{lemma}[Inclusion of DTLC]
  \label{lemma:inclusion_of_dtlc}
  Suppose $\SGradynt{t}$ is a closed term of DTLC. Then
  \begin{itemize}
  \item[i.] $  \cdot   \vdash   \lceil  \SGradynt{t}  \rceil   :  \SGradysym{\mbox{?}} $, and
  \item[ii.] $ \SGradynt{t}  \rightsquigarrow^*_{DTLC}  \SGradynt{t'} $ if and only if $  \lceil  \SGradynt{t}  \rceil   \rightsquigarrow^*   \lceil  \SGradynt{t'}  \rceil  $.
  \end{itemize}
\end{lemma}
\begin{proof}
  In this case DTLC is embedded into the simply typed fragment of
  Grady, and hence, this proof is the same result proven by
  \cite{Siek:2006}, and \cite{Siek:2015}.
\end{proof}

\renewcommand{\SGradydrulePXXUName}{\SGradysym{\mbox{?}}}
\renewcommand{\SGradydrulePXXreflName}{\text{refl}}
\renewcommand{\SGradydrulePXXarrowName}{\to}
\renewcommand{\SGradydrulePXXprodName}{\times}
\renewcommand{\SGradydrulePXXlistName}{\mathsf{List}}
\renewcommand{\SGradydrulePXXforallName}{\forall}
\begin{figure}
  \begin{mdframed}
    \begin{mathpar}
      \SGradydrulePXXU{} \and
      \SGradydrulePXXrefl{} \and
      \SGradydrulePXXarrow{} \and
      \SGradydrulePXXprod{} \and
      \SGradydrulePXXlist{} \and
      \SGradydrulePXXforall{}      
    \end{mathpar}
  \end{mdframed}
  \caption{Type Precision}
  \label{fig:type-pre}
\end{figure}

\begin{lemma}
  \label{lemma:consistent-subtyping-1}
  Suppose $ \Gamma  \vdash  \SGradynt{A}  \lesssim  \SGradynt{B} $.
  \begin{enumerate}[label=\roman*., align=left]
  \item $ \Gamma  \vdash  \SGradynt{A}  \sim  \SGradynt{A'} $ and $[[G |- A' <: B]]$ for some $\SGradynt{A'}$.
  \item $ \Gamma  \vdash  \SGradynt{B'}  \sim  \SGradynt{B} $ and $[[G |- A <: B']]$ for some $\SGradynt{B'}$.
  \end{enumerate}
\end{lemma}
\begin{proof}
  This is a proof by induction on $ \Gamma  \vdash  \SGradynt{A}  \lesssim  \SGradynt{B} $.  We only show a
  few of the most interesting cases.
  \begin{itemize}
  \item[] Case.\ \\ 
    \begin{center}
      \begin{math}
        $$\mprset{flushleft}
        \inferrule* [right=$\SGradydruleSXXBoxName{}$] {
           \Gamma  \vdash  \SGradynt{A}  : \star 
        }{ \Gamma  \vdash  \SGradynt{A}  \lesssim  \SGradysym{\mbox{?}} }
      \end{math}
    \end{center}
    In this case $\SGradynt{B} = \SGradysym{\mbox{?}}$.

    \noindent
    \textbf{Part i.} Choose $\SGradynt{A'} = \SGradysym{\mbox{?}}$.

    \noindent
    \textbf{Part ii.} Choose $\SGradynt{B'} = \SGradynt{A}$.

  \item[] Case.\ \\ 
    \begin{center}
      \begin{math}
        $$\mprset{flushleft}
        \inferrule* [right=$\SGradydruleSXXUnboxName{}$] {
           \Gamma  \vdash  \SGradynt{B}  : \star 
        }{ \Gamma  \vdash  \SGradysym{\mbox{?}}  \lesssim  \SGradynt{B} }
      \end{math}
    \end{center}
    In this case $\SGradynt{A} = \SGradysym{\mbox{?}}$.

    \noindent
    \textbf{Part i.} Choose $\SGradynt{A'} = \SGradynt{B}$.

    \noindent
    \textbf{Part ii.} Choose $\SGradynt{B'} = \SGradysym{\mbox{?}}$.

  \item[] Case.\ \\ 
    \begin{center}
      \begin{math}
        $$\mprset{flushleft}
        \inferrule* [right=$\SGradydruleSXXArrowName{}$] {
            \Gamma  \vdash  \SGradynt{A_{{\mathrm{2}}}}  \lesssim  \SGradynt{A_{{\mathrm{1}}}}   \quad   \Gamma  \vdash  \SGradynt{B_{{\mathrm{1}}}}  \lesssim  \SGradynt{B_{{\mathrm{2}}}}  
        }{ \Gamma  \vdash  \SGradysym{(}  \SGradynt{A_{{\mathrm{1}}}}  \rightarrow  \SGradynt{B_{{\mathrm{1}}}}  \SGradysym{)}  \lesssim  \SGradysym{(}  \SGradynt{A_{{\mathrm{2}}}}  \rightarrow  \SGradynt{B_{{\mathrm{2}}}}  \SGradysym{)} }
      \end{math}
    \end{center}

    In this case $\SGradynt{A} = \SGradynt{A_{{\mathrm{1}}}}  \rightarrow  \SGradynt{B_{{\mathrm{1}}}}$ and $\SGradynt{B} = \SGradynt{A_{{\mathrm{2}}}}  \rightarrow  \SGradynt{B_{{\mathrm{2}}}}$.

    \noindent
    \textbf{Part i.} By part two of the induction hypothesis we know
    that $ \Gamma  \vdash  \SGradynt{A'_{{\mathrm{1}}}}  \sim  \SGradynt{A_{{\mathrm{1}}}} $ and $[[G |- A2 <: A1']]$, and by part one of the induction hypothesis
    $ \Gamma  \vdash  \SGradynt{B_{{\mathrm{1}}}}  \sim  \SGradynt{B'_{{\mathrm{1}}}} $ and $[[G |- B1' <: B2]]$.  By symmetry of type consistency
    we may conclude that $ \Gamma  \vdash  \SGradynt{A_{{\mathrm{1}}}}  \sim  \SGradynt{A'_{{\mathrm{1}}}} $ which along with $ \Gamma  \vdash  \SGradynt{B_{{\mathrm{1}}}}  \sim  \SGradynt{B'_{{\mathrm{1}}}} $
    implies that $ \Gamma  \vdash  \SGradysym{(}  \SGradynt{A_{{\mathrm{1}}}}  \rightarrow  \SGradynt{B_{{\mathrm{1}}}}  \SGradysym{)}  \sim  \SGradysym{(}  \SGradynt{A'_{{\mathrm{1}}}}  \rightarrow  \SGradynt{B'_{{\mathrm{1}}}}  \SGradysym{)} $, and by reapplying the rule
    we may conclude that $[[G |- (A1' -> B1') <: (A2 -> B2)]]$.

    \noindent
    \textbf{Part ii.} Similar to part one, except that we first
    applying part one of the induction hypothesis to the first
    premise, and then the second part to the second premise.
    
  \end{itemize}

\end{proof}

\begin{lemma}
  \label{lemma:consistent-subtyping-2}
  If $[[G |- A <: B]]$, then $ \Gamma  \vdash  \SGradynt{A}  \lesssim  \SGradynt{B} $.
\end{lemma}
\begin{proof}
  This proof holds by straightforward induction on $[[G |- A <: B]]$.
\end{proof}

\begin{lemma}
  \label{lemma:consistent-subtyping-3}
  if $ \Gamma  \vdash  \SGradynt{A}  \sim  \SGradynt{B} $, then $ \Gamma  \vdash  \SGradynt{A}  \lesssim  \SGradynt{B} $.
\end{lemma}
\begin{proof}
  By straightforward induction on $ \Gamma  \vdash  \SGradynt{A}  \sim  \SGradynt{B} $.
\end{proof}

\begin{corollary}[Consistent Subtyping]
  \label{corollary:consistent_subtyping}
  \begin{enumerate}[label=\roman*.,align=left]
  \item[]
  \item $ \Gamma  \vdash  \SGradynt{A}  \lesssim  \SGradynt{B} $ if and only if $ \Gamma  \vdash  \SGradynt{A}  \sim  \SGradynt{A'} $ and $[[G |- A' <: B]]$ for some $\SGradynt{A'}$.
  \item $ \Gamma  \vdash  \SGradynt{A}  \lesssim  \SGradynt{B} $ if and only if $ \Gamma  \vdash  \SGradynt{B'}  \sim  \SGradynt{B} $ and $[[G |- A <: B']]$ for some $\SGradynt{B'}$.
  \end{enumerate}
\end{corollary}
\begin{proof}
  The left-to-right direction of both cases easily follows from
  Lemma~\ref{lemma:consistent-subtyping-1}, and the right-to-left
  direction of both cases follows from induction on the type
  consistency derivation with a case split on the subtyping derivation,
  and Lemma~\ref{lemma:consistent-subtyping-2} and Lemma~\ref{lemma:consistent-subtyping-3}.
\end{proof}

\begin{theorem}[Gradual Guarantee]
  \label{thm:gradual_guarantee}
  Suppose $  \cdot   \vdash  \SGradynt{t}  :  \SGradynt{A} $ and $ \SGradynt{t}  \sqsubseteq  \SGradynt{t'} $.  Then
  \begin{enumerate}[label=\roman*., align=left]     
  \item $  \cdot   \vdash  \SGradynt{t'}  :  \SGradynt{B} $ and $ G \vdash  \SGradynt{A}  \sqsubseteq  \SGradynt{B} $,
  \item if $ \SGradynt{t}  \rightsquigarrow^*  \SGradynt{v} $, then $ \SGradynt{t'}  \rightsquigarrow^*  \SGradynt{v'} $ and $ \SGradynt{v}  \sqsubseteq  \SGradynt{v'} $,
  \item if $ \SGradynt{t}  \uparrow $, then $ \SGradynt{t'}  \uparrow $,
  \item if $ \SGradynt{t'}  \rightsquigarrow^*  \SGradynt{v'} $, then $ \SGradynt{t}  \rightsquigarrow^*  \SGradynt{v} $ where $ \SGradynt{v}  \sqsubseteq  \SGradynt{v'} $, or $[[t ~>* error]]$, and
  \item if $ \SGradynt{t'}  \uparrow $, then $ \SGradynt{t}  \uparrow $ or $[[t ~>* error]]$.
  \end{enumerate}
\end{theorem}
\begin{proof}
  
\end{proof}
